---

name: "Devcontainer-CI"

on:
  # workflow_dispatch:
  pull_request:
    branches: [ dev ]

jobs:

  devcontainer-ci:
    runs-on: ubuntu-latest
    steps:

      - name: Checkout (GitHub)
        uses: actions/checkout@v3

      - name: Install devcontainer CLI
        run: npm install -g @devcontainers/cli

      - name: Build dev container
        run: |
          devcontainer build \
            --config .devcontainer/dev-container/devcontainer.json \
            --workspace-folder .devcontainer/dev-container \
            --image-name devcontainer-ci

      - name: Start dev container
        run: |
          devcontainer up \
          --config .devcontainer/dev-container/devcontainer.json \
          --workspace-folder .devcontainer/dev-container

      - name: Check if devcontainer-cli is installed
        run: devcontainer exec --config .devcontainer/dev-container/devcontainer.json --workspace-folder .devcontainer/dev-container devcontainer --version
